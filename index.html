<!DOCTYPE html>
<html lang="ar">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>ูุธุงู ุชุญุฏูุฏ ุงููุงุท ุงูุชูููุฑ ููุทูู  </title>
    <link rel="stylesheet" href="style.css">  <!-- ุฑุจุท ููู ุงูู CSS -->
</head>
<body>
    <header>
        <h2>  ุงุฎุชุจุงุฑ ุชุญุฏูุฏ ุงููุงุท ุงูุดุฎุตูุฉ ูุทูู ุงูุฑูุถุฉ ( ููุทู ุดุฎุตูุชู )  </h2>
        <img src="asses/logo.png" alt="" width="80px" >
    </header>
    <main>

        <div id="startSection">
            <h3>ุฅุจุฏุง ุจุฅุฏุฎุงู ุจูุงูุงุช ุงูุทูู</h3>
            <input type="text" id="childName" placeholder="ุฃุฏุฎู ุงุณู ุงูุทูู" />
            <input type="text" id="childDesc" placeholder="ุฃุฏุฎู ุงููุตู" />
            <div class="startbtncontainer">
                <button id="startBtn">ุงุจุฏุฃ</button>
                <button id="storeda">ุงูุฅุทูุงุน ุนูู ุงููุชุงุฆุฌ ุงููุญููุธู</button>
                <h5 style="text-align: center; color: dimgray;">ุฌููุน ุงูุตูุฑ ุงููุณุชุฎุฏูุฉ ุชู ุงูุดุงุฆูุง ุจูุงุณุทุฉ ุงูุฐูุงุก ุงูุฅุตุทูุงุนู</h5>
            </div>
           

        </div>

        <div class="quistioncontainer" style="display: none;">
             <h2 id="questionText">ูู ุชุฑูุฏ ูุนุฑูุฉ ุงููุฒูุฏุ</h2>
        <div class="img-container">
    <div class="answercard">
        <img src="" alt="" class="answer-image" data-value="1">
        <h3 class="image-title">ุงูุนููุงู ุงููุฑุนู 1</h3>
    </div>
    <div class="answercard">
        <img src="" alt="" class="answer-image" data-value="2">
        <h3 class="image-title">ุงูุนููุงู ุงููุฑุนู 2</h3>
    </div>
    <div class="answercard">
        <img src="" alt="" class="answer-image" data-value="3">
        <h3 class="image-title">ุงูุนููุงู ุงููุฑุนู 3</h3>
    </div>
    <div class="answercard">
        <img src="" alt="" class="answer-image" data-value="4">
        <h3 class="image-title">ุงูุนููุงู ุงููุฑุนู 4</h3>
    </div>
</div>

<div class="actionconatiner">
    <button id="yesBtn">ุงูุชุงูู</button>
    <button id="noBtn">ุชุณููู</button>
    <!-- <button id="saveResultBtn">๐พ ุญูุธ ุงููุชูุฌุฉ</button> -->
    <p id="saveStatus"></p>

</div>    

 <div id="myModal" class="modal">
            <div class="modal-content">
                <h1>ูุชูุฌุฉ ุงูุงุฎุชุจุงุฑ</h1>
                <p id="resultMessage" style="font-size: large;">ููุท ุงูุดุฎุตูุฉ ููุทูู ูู : </p>
                <button id="closeModalBtn" class="close-btn">ุฅุบูุงู</button>
                <button id="saveResultBtn" class="save-btn">๐พ ุญูุธ ุงููุชูุฌุฉ</button>
            </div>
</div>
        
        <!-- <button id="clickMe">ุงุถุบุท ููุง</button> -->
    </main>
    <script src="app.js"></script>

    <script type="module">
  import { initializeApp } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-app.js";
  import { getFirestore, collection, addDoc } from "https://www.gstatic.com/firebasejs/12.3.0/firebase-firestore.js";

  const firebaseConfig = {
    apiKey: "AIzaSyB-FZIk3MoPegDHsmDDUzl5pYCzi4AnlEQ",
    authDomain: "studentpatterns.firebaseapp.com",
    projectId: "studentpatterns",
    storageBucket: "studentpatterns.firebasestorage.app",
    messagingSenderId: "533359813954",
    appId: "1:533359813954:web:909cbdcd20733ac6e994db"
  };

  const app = initializeApp(firebaseConfig);
  const db = getFirestore(app);

  // ๐น ุฏุงูุฉ ุงูุญูุธ
  async function saveResultToFirebase() {
    const finalResult = window.currentThinkingStyle || "ุบูุฑ ูุญุฏุฏ";

    // ุฌูุจ ุงุณู ุงูุทูู ูุงููุตู ูู selectedValues
    const childNameObj = selectedValues.find(v => v.key === "childName");
    const childDescObj = selectedValues.find(v => v.key === "childDesc");

    const childName = childNameObj ? childNameObj.value : "";
    const childDesc = childDescObj ? childDescObj.value : "";

    if (!childName || !childDesc) {
      alert("ุงูุฑุฌุงุก ุฅุฏุฎุงู ุงุณู ุงูุทูู ูุงููุตู ูู ุฃูู ุณุคุงููู");
      return;
    }

    // ุงูุฅุฌุงุจุงุช ุงูุตูุฑูุฉ
    const imageAnswers = selectedValues.filter(v => typeof v === "string");

    try {
      await addDoc(collection(db, "results"), {
        name: childName,
        desc: childDesc,
        answers: imageAnswers,
        thinkingStyle: finalResult,
        createdAt: new Date()
      });
      document.getElementById("saveStatus").innerText = "โ ุชู ุญูุธ ุงููุชูุฌุฉ";
      alert("ุชู ุญูุธ ุงููุชูุฌุฉ ุจูุฌุงุญ ูู Firebase");
    } catch (e) {
      console.error("Error adding document: ", e);
      document.getElementById("saveStatus").innerText = "โ ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุงูุญูุธ";
      alert("ุญุฏุซ ุฎุทุฃ ุฃุซูุงุก ุงูุญูุธ ูู Firebase");
    }
  }

  // ๐น ุฑุจุท ุงูุฒุฑ
  document.getElementById("saveResultBtn").addEventListener("click", () => {
             const resultMessage = document.getElementById("resultMessage");
    resultMessage.innerText = "ุชู ุญูุธ ุงููุชูุฌุฉ ุจูุฌุงุญ  " ;

    const modal = document.getElementById("myModal");
    modal.style.display = "flex";
        saveResultToFirebase();
        });


document.getElementById("noBtn").addEventListener("click", () => {
    // ุชุฃูุฏ ูู ุญุณุงุจ ููุท ุงูุชูููุฑ ูุจู ุงุณุชุฎุฏุงูู
    const resultMessage = document.getElementById("resultMessage");
    const thinkingStyle = detectThinkingStyle(selectedValues); // ุงุญุณุจ ุงูููุท
    resultMessage.innerText = "ููุท ุงูุดุฎุตูุฉ ููุทูู ูู : " + thinkingStyle;

    const modal = document.getElementById("myModal");
    modal.style.display = "flex"; // ุนุฑุถ ุงููุงูุฐุฉ ุงูููุจุซูุฉ

    // ุญูุธ ุงููุชูุฌุฉ ูู Firebase ุนูุฏ ุงูุชุณููู
    
});

   
</script>




</body>  <!-- ุฑุจุท ููู ุงูู JavaScript -->
</body>
</html>





